(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6bb750ae"],{"206d":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACYAAAAmCAYAAACoPemuAAAAAXNSR0IArs4c6QAAAJ5JREFUWAnt2DEKwDAMA8Ck9Cl9e/Ko9i8uXrUIBQ8eVMhgUEW4Zggdo+jZe7+5iurGXVUUEU9VV/ZclWWVXd6Yqmkxi6kCat5nzGKqgJr3GbOYKqDm256xmbfO6kueqoP5OefXVgw3ezyvtSLXcQG82FbMG4MvRUeLUSIIWAxA6GgxSgQBiwEIHS1GiSBgMQChY1uxsn+weR2mDELgB3FmFp5YffVrAAAAAElFTkSuQmCC"},"9e64":function(e,t,i){},b8ca:function(e,t,i){},bd5e:function(e,t,i){"use strict";i("9e64")},c19f:function(e,t,i){"use strict";var a=i("23e7"),o=i("da84"),s=i("621a"),r=i("2626"),n="ArrayBuffer",l=s[n],c=o[n];a({global:!0,forced:c!==l},{ArrayBuffer:l}),r(n)},cbc3:function(e,t,i){"use strict";var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"finish_room"},[i("div",{staticClass:"finish_room2"},[i("div",{attrs:{images:e.photo}},e._l(e.photo,(function(t,a){return i("div",{key:a,staticClass:"room_img"},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:"string"==typeof t?t:t.url,expression:"typeof item == 'string' ? item : item.url"}]}),e.disabled?e._e():i("div",{staticClass:"im-button",on:{click:function(t){return e.deleteImg(a)}}},[i("div",{staticClass:"im-close"}),i("div",{staticClass:"im-close1"})])])})),0),e.photo.length<e.limit?i("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"room_add_img"},[e._m(0),i("input",{attrs:{disabled:e.disabled,type:"file"},on:{change:e.add_img}})]):e._e()])])},o=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("span",{staticStyle:{"margin-top":"35px"}},[a("img",{attrs:{src:i("206d")}})])}],s=(i("a434"),i("c19f"),i("a9e3"),i("d3b7"),i("ac1f"),i("1276"),i("5cc6"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("72f7"),i("bc3a")),r=i.n(s),n={props:{limit:{type:Number,default:function(){return 1}},updDir:{type:String,default:function(){return"error"}},disabled:{type:Boolean,default:function(){return!1}},isCompress:{type:Boolean,default:function(){return!1}},value:{type:[Array,String],default:function(){return[]}}},data:function(){return{photo:[],loading:!1}},watch:{photo:function(){1==this.limit?this.$emit("input",this.photo.length>0?this.photo[0].url:""):this.$emit("input",this.photo)},value:function(){1==this.limit?this.value instanceof Array?this.photo=[]:this.photo=this.value?[{url:this.value}]:[]:this.photo=this.value||[],"string"==typeof this.photo&&(this.photo=[this.photo])}},mounted:function(){1==this.limit?this.value instanceof Array?this.photo=[]:this.photo=this.value?[this.value]:[]:this.photo=this.value||[],"string"==typeof this.photo&&(this.photo=[this.photo])},methods:{deleteImg:function(e){this.photo.splice(e,1)},compress:function(e){var t=null,i=document.createElement("canvas"),a=e.height/e.width;i.width=720,i.height=720*a;var o=i.getContext("2d");return o.clearRect(0,0,i.width,i.height),o.drawImage(e,0,0,i.width,i.height),t=i.toDataURL("image/jpeg"),t},dataURItoBlob:function(e){for(var t=window.atob(e.split(",")[1]),i=e.split(",")[0].split(":")[1].split(";")[0],a=new ArrayBuffer(t.length),o=new Uint8Array(a),s=0;s<t.length;s++)o[s]=t.charCodeAt(s);return new window.Blob([a],{type:i})},add_img:function(e){var t=e.target.files[0];if(/\.(gif|jpg|jpeg|png|GIF|JPG|PNG)$/.test(e.target.value)){var i=10485760,a=t.size;if(a>i)return e.target.value="",void this.$notify.error({title:"上传图片错误",message:"上传图片不能超过10M"});this.loading=!0;var o=new FileReader,s=this;o.readAsDataURL(t);var n=new Image,l=this.updDir;o.onload=function(i){n.src=this.result,n.onload=function(){var a=this,o=i.target.result,c=t;s.isCompress&&(o=s.compress(n),c=s.dataURItoBlob(o));var d=new window.FormData;d.append("file",c),r()({method:"POST",url:"/upload/uploadImage/"+l,data:d,timeout:1e6,headers:{"Content-Type":"multipart/form-data"}}).then((function(i){e.target.value="",s.photo.push({fileName:t.fileName,url:i.data.data}),s.loading=!1})).catch((function(t){e.target.value="",s.loading=!1,a.$message.error(t.message)}))}}}else e.target.value="",this.$notify.error({title:"上传图片错误",message:"请上传gif|jpg|jpeg|png|GIF|JPG|PNG格式图片"})}}},l=n,c=(i("f960"),i("2877")),d=Object(c["a"])(l,a,o,!1,null,null,null);t["a"]=d.exports},d267:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"ele-body"},[i("el-card",{attrs:{shadow:"never"}},[i("el-form",{staticClass:"ele-form-search",attrs:{model:e.table.where,"label-width":"90px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.$refs.table.reload()},submit:function(e){e.preventDefault()}}},[i("el-row",{attrs:{gutter:15}},[i("el-col",{attrs:{md:6,sm:12}},[i("el-form-item",{attrs:{label:"广告标题:"}},[i("el-input",{attrs:{placeholder:"请输入广告标题",clearable:""},model:{value:e.table.where.title,callback:function(t){e.$set(e.table.where,"title",t)},expression:"table.where.title"}})],1)],1),i("el-col",{attrs:{md:9,sm:12}},[i("div",{staticClass:"ele-form-actions"},[i("el-button",{staticClass:"ele-btn-icon",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.$refs.table.reload()}}},[e._v("查询 ")]),i("el-button",{on:{click:function(t){(e.table.where={})&&e.$refs.table.reload()}}},[e._v("重置")])],1)])],1)],1),i("div",{staticClass:"ele-table-tool ele-table-tool-default"},[e.permission.includes("sys:ad:add")?i("el-button",{staticClass:"ele-btn-icon",attrs:{type:"primary",icon:"el-icon-plus",size:"small"},on:{click:function(t){e.showEdit=!0}}},[e._v("添加 ")]):e._e(),e.permission.includes("sys:ad:dall")?i("el-button",{staticClass:"ele-btn-icon",attrs:{type:"danger",icon:"el-icon-delete",size:"small"},on:{click:function(t){return e.remove()}}},[e._v("批量删除 ")]):e._e()],1),i("ele-data-table",{ref:"table",attrs:{config:e.table,choose:e.choose,height:"calc(100vh - 315px)","highlight-current-row":""},on:{"update:choose":function(t){e.choose=t}},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.index;return[i("el-table-column",{attrs:{type:"selection",width:"45",align:"center",fixed:"left"}}),i("el-table-column",{attrs:{type:"index",index:a,label:"编号",width:"60",align:"center",fixed:"left","show-overflow-tooltip":""}}),i("el-table-column",{attrs:{label:"广告封面","min-width":"100",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){var t=e.row;return[i("el-avatar",{attrs:{shape:"square",size:25,src:t.cover}})]}}],null,!0)}),i("el-table-column",{attrs:{label:"创建时间",sortable:"custom","show-overflow-tooltip":"","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v(e._s(e._f("toDateString")(1e3*i.create_time)))]}}],null,!0)}),i("el-table-column",{attrs:{label:"更新时间",sortable:"custom","show-overflow-tooltip":"","min-width":"160"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.row;return[e._v(e._s(e._f("toDateString")(1e3*i.update_time)))]}}],null,!0)}),i("el-table-column",{attrs:{label:"操作",width:"130px",align:"center",resizable:!1,fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e.permission.includes("sys:ad:edit")?i("el-link",{attrs:{icon:"el-icon-edit",type:"primary",underline:!1},on:{click:function(t){return e.edit(a)}}},[e._v("修改")]):e._e(),i("el-popconfirm",{staticClass:"ele-action",attrs:{title:"确定要删除此广告吗？"},on:{confirm:function(t){return e.remove(a)}}},[e.permission.includes("sys:ad:delete")?i("el-link",{attrs:{slot:"reference",icon:"el-icon-delete",type:"danger",underline:!1},slot:"reference"},[e._v("删除")]):e._e()],1)]}}],null,!0)})]}}])})],1),i("el-dialog",{attrs:{title:(e.editForm.id,"修改广告"),visible:e.showEdit,width:"700px","destroy-on-close":!0,"custom-class":"ele-dialog-form","lock-scroll":!1},on:{"update:visible":function(t){e.showEdit=t},closed:function(t){e.editForm={}}}},[i("el-form",{ref:"editForm",attrs:{model:e.editForm,rules:e.editRules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"广告图片:"}},[i("uploadImage",{attrs:{limit:1},model:{value:e.editForm.cover,callback:function(t){e.$set(e.editForm,"cover",t)},expression:"editForm.cover"}})],1)],1),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(t){e.showEdit=!1}}},[e._v("取消")]),i("el-button",{attrs:{type:"primary"},on:{click:e.save}},[e._v("保存")])],1)],1)],1)},o=[],s=(i("d81d"),i("5530")),r=i("cbc3"),n=i("2f62"),l={name:"SysAd",components:{uploadImage:r["a"]},data:function(){return{table:{url:"/ad/index",where:{}},choose:[],showEdit:!1,editForm:{status:1},editRules:{title:[{required:!0,message:"请输入广告标题",trigger:"blur"}],ad_sort_id:[{required:!0,message:"请选择所属广告位",trigger:"blur"}],type:[{required:!0,message:"请选择广告类型",trigger:"blur"}],description:[{required:!0,message:"请输入广告描述",trigger:"blur"}],width:[{required:!0,message:"请输入广告宽度",trigger:"blur"}],height:[{required:!0,message:"请输入广告高速",trigger:"blur"}],sort:[{required:!0,message:"请输入排序",trigger:"blur"}]},adSortList:[]}},computed:Object(s["a"])({},Object(n["b"])(["permission"])),mounted:function(){this.getAdSortList()},methods:{edit:function(e){this.editForm=Object.assign({},e),this.showEdit=!0},save:function(){var e=this;this.$refs["editForm"].validate((function(t){if(!t)return!1;var i=e.$loading({lock:!0});e.$http.post("/ad/edit",e.editForm).then((function(t){i.close(),0===t.data.code?(e.showEdit=!1,e.$message({type:"success",message:t.data.msg}),e.$refs.table.reload()):e.$message.error(t.data.msg)})).catch((function(t){i.close(),e.$message.error(t.message)}))}))},remove:function(e){var t=this;if(e){var i=this.$loading({lock:!0});this.$http.post("/ad/delete",{id:e.id}).then((function(e){i.close(),0===e.data.code?(t.$message({type:"success",message:e.data.msg}),t.$refs.table.reload()):t.$message.error(e.data.msg)})).catch((function(e){i.close(),t.$message.error(e.message)}))}else{if(0===this.choose.length)return this.$message.error("请至少选择一条数据");var a=this.choose.map((function(e){return e.id}));this.$confirm("确定要删除选中的广告吗?","提示",{type:"warning"}).then((function(){var e=t.$loading({lock:!0});t.$http.post("/ad/delete",{id:a}).then((function(i){e.close(),0===i.data.code?(t.$message({type:"success",message:i.data.msg}),t.$refs.table.reload()):t.$message.error(i.data.msg)})).catch((function(i){e.close(),t.$message.error(i.message)}))})).catch((function(){return 0}))}},getAdSortList:function(){var e=this;this.$http.get("/adsort/getAdSortList").then((function(t){0===t.data.code?e.adSortList=t.data.data:e.$message.error(t.data.msg)})).catch((function(t){e.$message.error(t.message)}))}}},c=l,d=(i("bd5e"),i("2877")),u=Object(d["a"])(c,a,o,!1,null,"337ae34e",null);t["default"]=u.exports},f960:function(e,t,i){"use strict";i("b8ca")}}]);